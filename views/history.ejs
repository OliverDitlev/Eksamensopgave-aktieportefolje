<body>
    <h1>Portfolio History</h1>

    <% if (history && history.length > 0) { %>
        <h2>Transaction History</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Action</th>
                    <th>Stock</th>
                    <th>Price</th>
                    <th>Quantity</th>
                </tr>
            </thead>
            <tbody>
                <% history.forEach(item => { %>
                    <tr>
                        <td><%= new Date(item.date).toLocaleDateString() %></td>
                        <td><%= item.action || 'N/A' %></td>
                        <td><%= item.stock %></td>
                        <td><%= item.price.toFixed(2) %> DKK</td>
                        <td><%= item.quantity %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } else { %>
        <p>No transactions found for this portfolio.</p>
    <% } %>

    <% if (averagePrices && averagePrices.length > 0) { %>
        <h2>Average Acquisition Prices</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Stock</th>
                    <th>Average Acquisition Price</th>
                    <th>Total Volume</th>
                </tr>
            </thead>
            <tbody>
                <% averagePrices.forEach(item => { %>
                    <tr>
                        <td><%= item.company %></td>
                        <td><%= item.stock %></td>
                        <td><%= item.average_price.toFixed(2) %> DKK</td>
                        <td><%= item.total_volume %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } else { %>
        <p>No average acquisition prices available.</p>
    <% } %>
</body>